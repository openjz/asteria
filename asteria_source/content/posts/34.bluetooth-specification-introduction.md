---
title: "蓝牙规范介绍"
date: 2023-01-29T05:27:00+08:00
draft: false

tags: ["蓝牙"]
categories: ["编程"]
---

## 蓝牙技术

蓝牙是一种无线通讯技术，蓝牙到目前为止一共发展了多代规范。从蓝牙4.0开始提出了BLE技术（Bluetooth Low Energy，蓝牙低功耗），一般把蓝牙4.0称为BLE，把之前的版本称为经典蓝牙（BR/EDR）。

以下列出了各代蓝牙技术

|技术|规范|版本|
|---|---|---|
|BR|1.1(2003)|Basic Rate (1 Mbit/s)|
|EDR|2.0(2004)|Enhance Data Rate (2-3 Mbit/s)|
|HS|3.0(2009)|High Speed (Alternate MAC/PHY)|
|LE|4.0(2010)|Low Energy (1 Mbit/s ultra low power)|

- BR，基础速率（Basic Rate），1.1版本，传输率约在1Mbit/s，因为是早期设计，容易受到同频率的产品干扰，影响通讯质量。
- EDR，增强速率（Enhanced Data Rate），大大提高了蓝牙数据传输速率，达到了2-3Mbit/s 。除了音频流传输更稳定和耗电量更低之外，还可充分利用带宽优势同时连接多个蓝牙设备。
- HS，High Speed。能利用WiFi作为数据传输方式，传输速度最高可达24Mbps。其核心是在802.11的基础上，通过集成802.11协议适配层，使得蓝牙协议栈可以根据任务和设备的不同，选择正确的射频。
- LE，低能耗（Low Energy），是蓝牙4.0版本提出的特性，特点是低功耗、短距离、可互操作，工作在免许可的2.4GHz ISM射频频段。

## 蓝牙host和蓝牙controller

蓝牙controller一般指蓝牙芯片控制部分，位于蓝牙技术的下层

蓝牙host一般指蓝牙协议栈，位于蓝牙技术的上层

## 蓝牙地址

经典蓝牙地址，长度48位（6字节），每个设备的经典蓝牙地址是唯一的，需要由企业向IEEE申请购买。

## CoD（Class of Device，设备类型）

长度24位（3字节），用来表明设备类型

## GATT（Generic Attribute Profile）

GATT（Generic Attribute Profile）是一种蓝牙通讯规范，用于在BLE连接上发送和接受短数据段。GATT是一种一对一的通信方式。

GATT通信的双方是C/S关系。外设作为GATT服务端（Server），维持ATT的查找表以及service和characteristic的定义。中心设备是GATT客户端（Client），负责向Server发起请求。

GATT从逻辑上由Profile、Service和Characteristic嵌套组成，一个Profile包含多个Service，一个Service包含多个Characteristic，Service和Characteristic都由唯一的UUID标识。

UUID长度为128位（16个字节），官方预先指定了一些UUID作为通用Service和Characteristic，形式是`0000xxxx-0000-1000-8000-00805f9b34fb`，只靠第96~111位这16位区分，其他位都是相同的。因此在官方文档中，UUID都是以类似`0x1800`的形式出现。

一个Service通常对应一种通信协议。

Characteristic是GATT的最小通信单位，一个Characteristic包含一个Characteristic declaration，一个Characteristic value和多个Characteristic descriptor。

GATT基于ATT（attribute protocol）协议进行通信。

## 工具

- NORDIC的调试工具nRF Connect，可用于调试ble

## 参考

- [https://www.bluetooth.com/specifications/specs/](https://www.bluetooth.com/specifications/specs/)
- [https://www.bluetooth.com/specifications/assigned-numbers/](https://www.bluetooth.com/specifications/assigned-numbers/)