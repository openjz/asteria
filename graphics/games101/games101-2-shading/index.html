
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://blog.shiwj.com/graphics/games101/games101-2-shading/">
      
      
        <link rel="prev" href="../75.games101-1-transform-rasterization/">
      
      
        <link rel="next" href="../games101-3-geometry/">
      
      
      <link rel="icon" href="../../../img/avatar.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>games101 二、着色 - Asteria</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#shading" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Asteria" class="md-header__button md-logo" aria-label="Asteria" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.45 4.73L5.82 21z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Asteria
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              games101 二、着色
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/openjz/asteria" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  主页

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../foundation/11.z2.go-gopl/" class="md-tabs__link">
          
  
  
  Foundation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../front-end/10.js-mdn-tutorial/" class="md-tabs__link">
          
  
  
  Front end

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../32.unity-webgl-deploy/" class="md-tabs__link">
          
  
  
  Graphics

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../interview/16.interview-bagu-golang/" class="md-tabs__link">
          
  
  
  Interview

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../linux/41.linux-so-dynamic-load/" class="md-tabs__link">
          
  
  
  Linux

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../math/15.remainder-and-modulo/" class="md-tabs__link">
          
  
  
  Math

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../multi-media/58.build_obs/" class="md-tabs__link">
          
  
  
  Multi media

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../others/11.z3.time/" class="md-tabs__link">
          
  
  
  Others

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../tools/38.bluetooth-tools/" class="md-tabs__link">
          
  
  
  Tools

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../windows/35.windows-devices-manage/" class="md-tabs__link">
          
  
  
  Windows

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Asteria" class="md-nav__button md-logo" aria-label="Asteria" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.45 4.73L5.82 21z"/></svg>

    </a>
    Asteria
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/openjz/asteria" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    主页
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Foundation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Foundation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/11.z2.go-gopl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    golang入门笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/50.php-install-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    php安装和配置
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/72.clrs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    《算法导论第3版》阅读笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/73.asemblly-wangshuang/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    《汇编语言第4版（王爽）》阅读笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Code design
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Code design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/code-design/51.closure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    闭包
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/code-design/70.design-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    《设计模式》阅读笔记
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Concurrent programming
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Concurrent programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/concurrent-programming/30.coroutine-stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    有栈协程和无栈协程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/concurrent-programming/37.condition-variable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    条件变量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/concurrent-programming/71.lockfree-ringbuffer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    无锁环形Buffer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cpp
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Cpp
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/20.cpp-stl-algorithm-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++标准库算法概览
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/23.cpp-new-malloc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++中new和malloc的区别
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/24.cpp-static/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++中的static
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/25.cpp-dup-symbols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++中符号重定义问题
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/26.cpp-copy-move/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++中的拷贝和移动语义
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/27.cpp-const/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++中的const
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/28.cpp-inline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    关于C++ inline关键字
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/29.cpp-forward-declaration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    关于C++前向声明
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/57.effective-cpp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    《Effective C++ 第三版》阅读笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/62.effective-modern-cpp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    《Effective Modern C++》阅读笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/65.cpp-template-tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++模板使用技巧
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/66.cpp-stl-tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++ STL使用技巧
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/67.cpp-operator-overloading-tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++ 运算符重载使用技巧
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/68.cpp-memory-analysis-asan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++内存分析：ASan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/cpp/69.cpp-memory-analysis-vld/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++内存分析：VLD
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Database
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Database
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/database/11.z1.mysql-crash-course/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mysql入门笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/database/13.mysql-complex-sql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mysql中的复杂查询
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Network
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/network/12.z1.ip-address/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    关于IP地址的发展
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Os
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            Os
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/os/14.threadexit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线程什么时候终止
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundation/os/74.csapp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    《深入理解计算机系统第3版》阅读笔记
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Front end
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Front end
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../front-end/10.js-mdn-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    js入门笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../front-end/11.css-mdn-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    css入门笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../front-end/17.html-mdn-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    html入门笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../front-end/18.webpage-print/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    打印html页面
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Graphics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Graphics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../32.unity-webgl-deploy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    如何部署unity生成的WebGL包
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../33.rendering-pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    渲染管线介绍
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Games101
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Games101
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../75.games101-1-transform-rasterization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    games101 一、变换和光栅化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    games101 二、着色
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    games101 二、着色
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shading" class="md-nav__link">
    <span class="md-ellipsis">
      着色（Shading）
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blinn-phong-blinn-phong-reflectance-model" class="md-nav__link">
    <span class="md-ellipsis">
      Blinn-Phong 反射模型（Blinn-Phong Reflectance Model）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Blinn-Phong 反射模型（Blinn-Phong Reflectance Model）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shading_1" class="md-nav__link">
    <span class="md-ellipsis">
      shading定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      法线变换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diffuse-reflection" class="md-nav__link">
    <span class="md-ellipsis">
      漫反射（Diffuse Reflection）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specular-highlight" class="md-nav__link">
    <span class="md-ellipsis">
      高光（Specular Highlight）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ambient-light" class="md-nav__link">
    <span class="md-ellipsis">
      环境光（Ambient Light）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      合起来
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shading-frequency" class="md-nav__link">
    <span class="md-ellipsis">
      着色频率（Shading Frequency）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="着色频率（Shading Frequency）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      题外话（一点思考）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      如何计算顶点的法线？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      如何对法线插值？
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-time-rendering-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      实时渲染管线（Real-time Rendering Pipeline）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="实时渲染管线（Real-time Rendering Pipeline）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shader" class="md-nav__link">
    <span class="md-ellipsis">
      Shader
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#texture-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      纹理映射（Texture Mapping）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="纹理映射（Texture Mapping）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#barycentric-coordinates-interpolation" class="md-nav__link">
    <span class="md-ellipsis">
      重心坐标插值（Barycentric Coordinates Interpolation）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      应用纹理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      纹理反走样
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mipmap" class="md-nav__link">
    <span class="md-ellipsis">
      Mipmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anisotropic-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      各向异性过滤（Anisotropic Filtering）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ewa-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      EWA Filtering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      环境贴图（Environment Mapping）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bump-mapping-normal-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      凹凸贴图 / 法线贴图（Bump Mapping / Normal Mapping）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displacement-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      位移贴图（Displacement Mapping）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      纹理的其他应用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shadow-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      阴影贴图（Shadow Mapping）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="阴影贴图（Shadow Mapping）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      如何实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      软阴影
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../games101-3-geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    games101 三、几何
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Interview
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Interview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../interview/16.interview-bagu-golang/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    面试八股-golang
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../interview/19.interview-bagu-cpp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    面试八股-c++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../interview/52.interview-bagu-general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    面试八股-通用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../interview/53.interview-bagu-distribute-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    面试八股-分布式系统
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/41.linux-so-dynamic-load/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linux 动态库so文件 动态加载
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/42.linux-jiu-gai-zhe-me-xue-note/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    《linux就该这么学》笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/43.linux-common-command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linux常用命令
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/44.linux-common-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linux常用配置
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/45.linux-net-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linux网络配置
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/47.linux-muti-thread-programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linux多线程编程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/9.linux-core-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linux core dump配置
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Math
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Math
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/15.remainder-and-modulo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    取余和取模的区别
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/31.linear-algebra-3B1B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性代数的几何意义
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/63.affine-transformation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    理解仿射变换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/64.calculus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    微积分学习笔记
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Multi media
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Multi media
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../multi-media/58.build_obs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    编译obs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../multi-media/59.ffmpeg_cmd_demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ffmpeg命令行例子
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Others
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Others
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/11.z3.time/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算机中的时间
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/12.digital-signatures-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数字签名, 数字证书以及加密通信
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/34.bluetooth-specification-introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    蓝牙相关知识
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/40.bug-record/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    一些开发过程中遇到的奇怪问题
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/38.bluetooth-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    蓝牙调试工具
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/46.ssh-login-script/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ssh登陆脚本
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/60.vscode-continue-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    vscode continue AI插件配置
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/61.understand-scitools-keygen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scientific Toolworks Understand 7.0.x 破解机使用方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_5" >
        
          
          <label class="md-nav__link" for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Build
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_5">
            <span class="md-nav__icon md-icon"></span>
            Build
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/build/21.makefile-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makefile笔记
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_6" >
        
          
          <label class="md-nav__link" for="__nav_10_6" id="__nav_10_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Nginx
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_6">
            <span class="md-nav__icon md-icon"></span>
            Nginx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/nginx/48.nginx-getting-started-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nginx入门教程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/nginx/49.nginx-install-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nginx安装和配置
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_7" >
        
          
          <label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Package manager
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7">
            <span class="md-nav__icon md-icon"></span>
            Package manager
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/package-manager/22.scl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    scl-rhel/centos软件运行环境
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Windows
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Windows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/35.windows-devices-manage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    windows设备管理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/39.windows-dump-debug/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    windows下调试dump文件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/54.windows_ifeo_windbg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    使用IFEO映像劫持+windbg在进程运行过程中调试
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/55.winodws_develop_knowledge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    一些和windows开发相关的小知识
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/56.char-wchar-on-windows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    char和wchar_t在windows上如何正确使用
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shading" class="md-nav__link">
    <span class="md-ellipsis">
      着色（Shading）
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blinn-phong-blinn-phong-reflectance-model" class="md-nav__link">
    <span class="md-ellipsis">
      Blinn-Phong 反射模型（Blinn-Phong Reflectance Model）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Blinn-Phong 反射模型（Blinn-Phong Reflectance Model）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shading_1" class="md-nav__link">
    <span class="md-ellipsis">
      shading定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      法线变换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diffuse-reflection" class="md-nav__link">
    <span class="md-ellipsis">
      漫反射（Diffuse Reflection）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specular-highlight" class="md-nav__link">
    <span class="md-ellipsis">
      高光（Specular Highlight）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ambient-light" class="md-nav__link">
    <span class="md-ellipsis">
      环境光（Ambient Light）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      合起来
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shading-frequency" class="md-nav__link">
    <span class="md-ellipsis">
      着色频率（Shading Frequency）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="着色频率（Shading Frequency）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      题外话（一点思考）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      如何计算顶点的法线？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      如何对法线插值？
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-time-rendering-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      实时渲染管线（Real-time Rendering Pipeline）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="实时渲染管线（Real-time Rendering Pipeline）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shader" class="md-nav__link">
    <span class="md-ellipsis">
      Shader
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#texture-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      纹理映射（Texture Mapping）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="纹理映射（Texture Mapping）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#barycentric-coordinates-interpolation" class="md-nav__link">
    <span class="md-ellipsis">
      重心坐标插值（Barycentric Coordinates Interpolation）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      应用纹理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      纹理反走样
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mipmap" class="md-nav__link">
    <span class="md-ellipsis">
      Mipmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anisotropic-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      各向异性过滤（Anisotropic Filtering）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ewa-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      EWA Filtering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      环境贴图（Environment Mapping）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bump-mapping-normal-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      凹凸贴图 / 法线贴图（Bump Mapping / Normal Mapping）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displacement-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      位移贴图（Displacement Mapping）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      纹理的其他应用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shadow-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      阴影贴图（Shadow Mapping）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="阴影贴图（Shadow Mapping）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      如何实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      软阴影
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>games101 二、着色</h1>

<h2 id="shading">着色（Shading）</h2>
<p>根据不同材质和光照条件，绘制物体的颜色，这个过程叫着色（Shading）。</p>
<p>着色是作用于一个个着色点（shading point）的。</p>
<h2 id="blinn-phong-blinn-phong-reflectance-model">Blinn-Phong 反射模型（Blinn-Phong Reflectance Model）</h2>
<ol>
<li>Specular highlight（镜面高光）</li>
<li>Diffuse reflection（漫反射）</li>
<li>Ambient reflection（环境光反射）</li>
</ol>
<h3 id="shading_1">shading定义</h3>
<p><img alt="shading-defs" src="/img/games101-notes/shading-defs.png" /></p>
<ul>
<li>Viewer direction <span class="arithmatex">\(\vec{v}\)</span>，观察者方向向量</li>
<li>Surface normal <span class="arithmatex">\(\vec{n}\)</span>，表面法线向量</li>
<li>Light direction <span class="arithmatex">\(\vec{l}\)</span>，光源方向向量</li>
<li>Surface parameters，表面材质参数</li>
<li>color</li>
<li>Shininess</li>
</ul>
<p>上面这些向量都是单位向量。</p>
<p>Shading考虑的是，在不同的光照和表面材质的作用下，表面上每个点的颜色是怎样的。</p>
<p>Shading只考虑一个物体自己和光线的交互，不考虑物体之间的相互影响，如阴影（Shadow）、反射（Reflection）等。</p>
<h3 id="_1">法线变换</h3>
<p>我们已经知道，顶点位置需要经过MV变换后，再做反射计算，那么自然，法线也需要经过变换后才能参与反射计算。</p>
<p>但是法线不能直接用MV矩阵变换，因为法线是垂直于表面的向量，直接用MV矩阵变换后，可能不再垂直于表面。</p>
<p>为了保证法线变换后仍然垂直于表面，我们需要用MV矩阵的逆转置矩阵（Inverse Transpose Matrix）来变换法线。</p>
<p>逆转置矩阵，即：</p>
<div class="arithmatex">\[(M^{-1})^T\]</div>
<h3 id="diffuse-reflection">漫反射（Diffuse Reflection）</h3>
<p>漫反射模拟光线照射到粗糙表面上的效果。</p>
<p>漫反射的入射光线会均匀地向各个方向反射。</p>
<p><strong>考虑光线接收</strong></p>
<p>Lambert的余弦定律（Lambert's Cosine Law）：</p>
<p>假设入射光线是平行的，物体表面的法线和入射光线夹角越大，单位表面接收到的光就越少，用 <span class="arithmatex">\(\theta\)</span> 表示入射光线和法线的夹角，<span class="arithmatex">\(cos\theta=\vec{l} \cdot \vec{n}\)</span>。</p>
<p><strong>考虑光线发射</strong></p>
<p>有一个点光源，我们可以以光源为中心，画出多个半径不同的球面，同一个球面上每个点的光照强度相同，不同球面的总光照强度相同，因此球面上的单个点的光照强度与距离光源的距离有关，距离越远强度越低。</p>
<p>定义 <span class="arithmatex">\(I\)</span> 为半径为1的球面上某一点的光照强度（Intensity），球面总光照强度为 <span class="arithmatex">\(4\pi I\)</span>，那么距离光源 <span class="arithmatex">\(r\)</span> 处的一点上光照强度为 <span class="arithmatex">\(I/r^2\)</span>。</p>
<p><strong>漫反射公式</strong></p>
<p>由此可得一个shading point上的漫反射公式：</p>
<div class="arithmatex">\[L_d = k_d \frac{I}{r^2} \max(0, \vec{l} \cdot \vec{n})\]</div>
<p>其中，<span class="arithmatex">\(k_d\)</span> 为漫反射系数
（Diffuse coefficient），为1时表示完全反射，亮度最亮，为0时表示完全吸收，亮度最暗，当它为向量时，表示的就是颜色系数。</p>
<p>由于漫反射均匀地向各个方向反射，所以不管从哪个方向观测，看到的颜色都是一样的。</p>
<h3 id="specular-highlight">高光（Specular Highlight）</h3>
<p>只有当观察方向和镜面反射方向接近时，才会看到高光，因此光照强度（Intensity）与观察方向有关。</p>
<p>观察方向和镜面反射方向接近也也意味着半程向量 <span class="arithmatex">\(\vec{h}\)</span> 和法线方向接近，半程向量是指光线入射方向和观察方向的角平分线方向。</p>
<div class="arithmatex">\[\vec{h} = \frac{\vec{l} + \vec{v}}{|\vec{l} + \vec{v}|}\]</div>
<p>高光的反射公式为：</p>
<div class="arithmatex">\[L_s = k_s \frac{I}{r^2} \max(0, \vec{h} \cdot \vec{n})^{p}\]</div>
<p>其中，<span class="arithmatex">\(\vec{h} \cdot \vec{n}\)</span> 为 半程向量和法线的夹角余弦 <span class="arithmatex">\(\cos{\alpha}\)</span>，<span class="arithmatex">\(k_s\)</span> 为高光系数（Specular coefficient），<span class="arithmatex">\(p\)</span> 是为了加快 <span class="arithmatex">\(\cos{\alpha}\)</span> 的衰减，<span class="arithmatex">\(p\)</span> 的值较大时，夹角 <span class="arithmatex">\(\alpha\)</span> 稍微大一点，<span class="arithmatex">\(\cos{\alpha}\)</span> 的值就会降低很多，高光就会衰减很快，体现在视觉上就是高光比较集中。</p>
<p>Blinn-Phong 模型将光线接收项 <span class="arithmatex">\(\vec{l} \cdot \vec{n}\)</span> 简化掉了。</p>
<h3 id="ambient-light">环境光（Ambient Light）</h3>
<p>环境光来自四面八方，我们假任何一个点接收到的环境光永远相同。</p>
<div class="arithmatex">\[L_a = k_a I_a\]</div>
<p><span class="arithmatex">\(I_a\)</span> 为环境光强度（Ambient Intensity），是一个恒定值，<span class="arithmatex">\(k_a\)</span> 为环境光系数（Ambient coefficient）。</p>
<h3 id="_2">合起来</h3>
<p>将三种光照模型合起来：</p>
<div class="arithmatex">\[L = L_a + L_d + L_s\]</div>
<h2 id="shading-frequency">着色频率（Shading Frequency）</h2>
<p>着色频率研究的是如何让渲染结果更精细，更平滑，比如，一个球体实际上是由很多三角形组成的，如果每个三角形只计算一个着色点，那么渲染出来的球体就会有棱角，为了解决这个问题，我们可以增加着色点的数量，比如在每个三角形内部进行插值计算，以提高着色频率，这样就能让渲染结果更平滑。</p>
<p>注意下面的方法提到了计算顶点法线，实际上，有些模型格式，例如obj格式，已经包含了顶点法线数据。</p>
<p><strong>Flat Shading (Face)</strong></p>
<p>一个三角形面只有一个法线，把三角形面视为一个平坦的平面。</p>
<p><strong>Gouraud Shading (Vertex)</strong></p>
<p>求出几个顶点的法线，计算出顶点的颜色，然后在三角形面内进行颜色插值。</p>
<p><strong>Phong Shading (Pixel)</strong></p>
<p>注意这个并不是Blinn-Phong反射模型。</p>
<p>求出几个顶点的法线，在三角形面内进行法线插值，然后计算出每个像素点的颜色。</p>
<h3 id="_3">题外话（一点思考）</h3>
<p>使用顶点法线插值，不会改变几何，只是光照时让几何体表面显得更平滑。</p>
<blockquote>
<p>这叫做法线平滑（Normal Smoothing）。</p>
</blockquote>
<p>如果我有个比较复杂的几何体，我希望它某一部分的渲染使用面法线，让他的棱角更分明，而其他部分使用顶点法线插值，让他的表面更圆滑，图形学上有这种技术吗？或者说，这对于图形学来说，是个问题吗？</p>
<p>gpt告诉我:</p>
<blockquote>
<p>有，并且非常常见。这不是问题，而是标准做法。</p>
<p>可用的技术与做法：</p>
<p>硬边/平滑组（Smoothing Groups）/法线拆分（Normal Split）：在硬边处“拆分顶点”，给该边两侧三角形的顶点写入各自的面法线；其余区域用平滑顶点法线。大多数DCC/引擎支持（OBJ/FBX可存“面-顶点法线”）。
按角度阈值生成法线：导入时按夹角&gt;阈值就断边，用面法线；否则合并求平均法线。
着色器里混合：在片元着色器同时拿到“插值法线”（平滑）和“几何面法线”，用掩码（顶点属性或纹理）选择或混合二者。</p>
<p>示例（GLSL 片元，世界或视空间一致）：</p>
</blockquote>
<pre><code class="language-glsl">// ...插值进来的数据...
in vec3 vPosWS;         // 片元位置(世界/视空间)
in vec3 vNormalWS;      // 插值后的平滑法线
in vec2 vUV;            // 可选，用于区域掩码
uniform sampler2D uMask; // R=1 用面法线，R=0 用平滑
// ...existing code...
void main() {
    vec3 N_smooth = normalize(vNormalWS);
    vec3 N_flat   = normalize(cross(dFdx(vPosWS), dFdy(vPosWS))); // 面法线
    float w = texture(uMask, vUV).r; // 或者用顶点属性/材质开关
    vec3 N = normalize(mix(N_smooth, N_flat, w));
    // 用 N 做后续光照
}
</code></pre>
<blockquote>
<p>其他要点：</p>
<ul>
<li>用 flat 插值限定符也可让某个 varying 按“每面”传值，但要保证三顶点携带相同数据或用几何着色器/顶点复制。</li>
<li>硬边会增加顶点数；若用 dFdx/dFdy 求面法线，请确保用同一空间的 vPos，并注意导数在分支/多采样处的连续性。</li>
<li>若用法线贴图，平滑区应保持一致的切线空间（常用 MikkTSpace）。</li>
</ul>
<p>结论：同一几何体中混合“面法线的硬朗”和“顶点法线的圆滑”是行业常规工作流，直接用硬边/平滑组或着色器掩码即可实现。</p>
</blockquote>
<p>以上全部都是gpt告诉我的。</p>
<h3 id="_4">如何计算顶点的法线？</h3>
<p>对顶点所在面的法线进行平均。</p>
<div class="arithmatex">\[
\vec{n}_v = \frac{\sum_{i=1}^{k} \vec{n}_i}{|\sum_{i=1}^{k} \vec{n}_i|}
\]</div>
<h3 id="_5">如何对法线插值？</h3>
<p>Barycentric coordinates interpolation（重心坐标插值）</p>
<h2 id="real-time-rendering-pipeline">实时渲染管线（Real-time Rendering Pipeline）</h2>
<ol>
<li>Vertex Processing，将顶点从模型空间变换到屏幕空间（MVP变换）</li>
<li>Triangle Processing，将顶点划分为一个个三角形</li>
<li>Rasterization，光栅化，将三角形离散化为一个个采样点（Fragments），抗锯齿</li>
<li>Fragment Processing，根据采样结果对每个像素进行着色，深度测试 / 可见性测试</li>
<li>Framebuffer Operations</li>
</ol>
<p>着色（Shading）主要发生在Vertex Processing 和 Fragment Processing，控制着色的程序叫做 Shader。</p>
<p>图形管线运行在GPU上，充分利用GPU的并行计算能力。</p>
<h3 id="shader">Shader</h3>
<p>Shader 需要用硬件上执行的语言来编写，比如 GLSL、HLSL 等。</p>
<p>Shader 只需要关心单个顶点或像素的着色，不需要写循环等控制结构。</p>
<p>Shader 分为两种：</p>
<ul>
<li>Vertex Shader，顶点着色器</li>
<li>Fragment Shader，片段着色器/像素着色器</li>
</ul>
<h2 id="texture-mapping">纹理映射（Texture Mapping）</h2>
<p>纹理是对表面上的每个点赋予一个属性。</p>
<p>纹理映射是把一张二维的图片映射到三维物体表面上的过程，物体表面的每一个顶点都要对应纹理上的一个点。</p>
<p>纹理上的坐标系通常称为uv坐标系，u表示水平方向，v表示垂直方向。</p>
<p>Tilable texture（可平铺纹理），纹理在上下左右方向上重复使用的时候，起到一种无缝衔接的效果。</p>
<p>纹理映射只规定了三维顶点和二维纹理坐标之间的映射关系，而对三角形面内的某一点来说，它的纹理坐标需要通过重心坐标插值来计算。</p>
<h3 id="barycentric-coordinates-interpolation">重心坐标插值（Barycentric Coordinates Interpolation）</h3>
<p>重心坐标插值可以用来做纹理坐标插值，法线插值，颜色插值等。</p>
<p>重心坐标的计算方法如下：</p>
<p>对于一个三角形 <span class="arithmatex">\(\triangle ABC\)</span>，以及三角形内的一个点 <span class="arithmatex">\(P\)</span>，我们可以将 <span class="arithmatex">\(P\)</span> 表示为 <span class="arithmatex">\(A\)</span>，<span class="arithmatex">\(B\)</span>，<span class="arithmatex">\(C\)</span> 的线性组合：</p>
<div class="arithmatex">\[P = \alpha A + \beta B + \gamma C\]</div>
<p>其中，<span class="arithmatex">\(\alpha + \beta + \gamma = 1\)</span>，且 <span class="arithmatex">\(\alpha, \beta, \gamma \geq 0\)</span>。</p>
<p>由 <span class="arithmatex">\(\alpha\)</span>、 <span class="arithmatex">\(\beta\)</span>、<span class="arithmatex">\(\gamma\)</span> 这三个系数构成的向量 <span class="arithmatex">\((\alpha, \beta, \gamma)\)</span> 就是点 <span class="arithmatex">\(P\)</span> 的重心坐标。</p>
<p><img alt="barycentric-coordinates" src="/img/games101-notes/barycentric-coordinates.png" /></p>
<p><span class="arithmatex">\(\alpha\)</span>、 <span class="arithmatex">\(\beta\)</span>、<span class="arithmatex">\(\gamma\)</span> 可以通过以下方法求出（<span class="arithmatex">\(A\)</span> 代表面积）：</p>
<div class="arithmatex">\[\alpha = \frac{A_A}{A_{ABC}}, \quad \beta = \frac{A_B}{A_{ABC}}, \quad \gamma = \frac{A_C}{A_{ABC}}\]</div>
<p>三角形的重心坐标为 <span class="arithmatex">\((\frac{1}{3}, \frac{1}{3}, \frac{1}{3})\)</span>，即，三角形的重心刚好将三角形分成三个等面积的小三角形。</p>
<p>假设点 <span class="arithmatex">\(P\)</span> 的坐标为 <span class="arithmatex">\((x,y)\)</span>，下面是计算 <span class="arithmatex">\(\alpha\)</span>、 <span class="arithmatex">\(\beta\)</span>、<span class="arithmatex">\(\gamma\)</span> 的公式（利用叉乘就可以推导出）：</p>
<div class="arithmatex">\[
\alpha =
\frac{-(x - x_B)(y_C - y_B) + (y - y_B)(x_C - x_B)}
      {-(x_A - x_B)(y_C - y_B) + (y_A - y_B)(x_C - x_B)}
\]</div>
<div class="arithmatex">\[
\beta =
\frac{-(x - x_C)(y_A - y_C) + (y - y_C)(x_A - x_C)}
      {-(x_B - x_C)(y_A - y_C) + (y_B - y_C)(x_A - x_C)}
\]</div>
<div class="arithmatex">\[
\gamma = 1 - \alpha - \beta
\]</div>
<p>对于任意向量的插值，也是一样的：</p>
<div class="arithmatex">\[V_P = \alpha V_A + \beta V_B + \gamma V_C\]</div>
<p><strong>由于在投影变换过程中，三角形会被拉伸变换，点的重心坐标会变，所以什么时候做插值，要区分清楚。</strong></p>
<h3 id="_6">应用纹理</h3>
<ol>
<li>光栅化后，对屏幕上的每一个采样点进行纹理坐标插值，得到对应的纹理坐标（<span class="arithmatex">\(u,v\)</span>），<span class="arithmatex">\(u,v\)</span> 坐标的值通常在0~1之间。</li>
<li>着色时，将纹理图片上的颜色作为漫反射系数 <span class="arithmatex">\(k_d\)</span>。</li>
</ol>
<h3 id="_7">纹理反走样</h3>
<p><strong>纹理放大（Texture Magnification）和纹理缩小（Texture Minification）</strong></p>
<p>纹理太大或太小，有可能发生在场景有一定深度时，近处的物体需要用大纹理，远处的物体需要用小纹理。</p>
<p><strong>texture太小怎么办？</strong></p>
<p>纹理图像中的一个像素叫做texel，纹理放大时需要对texel进行插值。</p>
<p>插值解决的是，给定一个非整数的纹理坐标，如何计算出对应的颜色。</p>
<p><strong>Bilinear Interpolation（双线性插值）</strong></p>
<p>如果是线性插值，很简单，比如我们想在 <span class="arithmatex">\(\vec{v_0}\)</span> 和 <span class="arithmatex">\(\vec{v_1}\)</span> 之间插值，插值系数为 <span class="arithmatex">\(x\)</span>，那么插值结果为：</p>
<div class="arithmatex">\[ lerp(x, \vec{v_0}, \vec{v_1}) = \vec{v_0} + x(\vec{v_1} - \vec{v_0})\]</div>
<p>双线性插值是在二维平面上的四个点构成的矩形区域内进行插值，实际上就是做三次线性插值，先在水平方向上做两次线性插值，然后在垂直方向上做一次线性插值。</p>
<p><strong>texture太大怎么办？</strong></p>
<p>texture太大，要把它映射到一个小的区域上，这个过程实际上是对纹理降低采样率采样，和覆盖测试类似，同样会出现走样问题（摩尔纹，锯齿等）。</p>
<p>从现象上看，出现走样是因为一个像素（即一个采样点）对应了一大块纹理区域。</p>
<p>解决方法:
1. 增加采样点
2. 不做采样，给定一个纹理区域，立刻得到这个区域的平均值</p>
<p>这实际上是两个理念的区别，Point Query 和 Range Query。</p>
<h3 id="mipmap">Mipmap</h3>
<p>Mipmap可以用来做正方形范围查询（Range Query）</p>
<p>Mipmap的原理是这样的，在渲染之前预先生成一系列不同分辨率的纹理图像，然后在渲染时根据需要选择合适分辨率的纹理图像进行采样。</p>
<p>我们把每个分辨率的图像称为1层，用 D 表示，D0 层为原始图像，D1 层为原始图像宽高各减半后的图像，D2 层为 D1 层宽高各减半后的图像，以此类推，每个层的图像大小为上一层的四分之一。</p>
<p>经过级数求和，可以知道总共需要4/3倍的存储空间，也就是说，Mipmap 仅需要额外的 1/3 存储空间。</p>
<p><strong>如何知道选择哪一层的图像？或者说，如何知道一个像素对应的纹理区域有多大？</strong></p>
<p>选择一个像素相邻的两个像素，计算它们在纹理空间中的距离，距离越大，说明纹理区域越大，选择的层数就越高。</p>
<p>以下公式可以近似计算出像素对应的Mipmap层数D，L代表像素对应的纹理空间的边长，它是取像素分别距离x方向和y方向上的像素在纹理空间中的距离的最大值，其中，<span class="arithmatex">\(x\)</span>和<span class="arithmatex">\(y\)</span>代表屏幕空间的坐标，<span class="arithmatex">\(u\)</span>和<span class="arithmatex">\(v\)</span>代表纹理空间的坐标。</p>
<div class="arithmatex">\[
D = \log_{2} L
\]</div>
<div class="arithmatex">\[
L = \max\!\left(
\sqrt{\left(\frac{du}{dx}\right)^2 + \left(\frac{dv}{dx}\right)^2},
\sqrt{\left(\frac{du}{dy}\right)^2 + \left(\frac{dv}{dy}\right)^2}
\right)
\]</div>
<p>举个例子，假如算出来的L是4，意味着，一个像素对应的原始纹理（D0层）区域是4x4的，而D2层的一个像素正好对应原始纹理的4x4区域，因此，我们应该选择D2层的图像进行采样。</p>
<p>如果D不是整数怎么办？比如D=1.8，很简单，使用插值，先在D1层和D2层分别做双线性插值，然后再对结果做线性插值，这叫做<strong>三线性插值（Trilinear Interpolation）</strong>。</p>
<p><strong>Mipmap的限制</strong></p>
<p>Mipmap只能处理正方形区域的查询，不能处理任意形状的区域查询。</p>
<p>这会导致深度较大的场景中，远处的物体可能会过于模糊。</p>
<h3 id="anisotropic-filtering">各向异性过滤（Anisotropic Filtering）</h3>
<p><img alt="anisotropic-filtering" src="/img/games101-notes/anisotropic-filtering.png" /></p>
<p>各项异性过滤预先计算出不同长宽比例的纹理图像，然后在渲染时根据需要选择合适的图像进行采样。</p>
<p>这叫Ripmap。</p>
<h3 id="ewa-filtering">EWA Filtering</h3>
<p>EWA Filtering（Elliptical Weighted Average Filtering，椭圆加权平均过滤）可以处理任意形状的区域查询。</p>
<p>它的原理是把一个不规则的纹理区域近似为多个椭圆，需要查询多次，然后对结果进行加权平均。</p>
<h3 id="environment-mapping">环境贴图（Environment Mapping）</h3>
<p>环境贴图是为了模拟物体表面的反射效果。</p>
<p>它是把不同方向的环境光照信息预先保存到纹理中，然后在渲染时根据物体表面的法线方向，从纹理中采样出对应的环境光照信息，作为物体表面的反射光照。</p>
<p>假设环境光都是来自无限远处，只记录环境光的方向信息。</p>
<p>球面环境贴图（Spherical Environment Mapping）是将环境光照信息映射到一个球面上。</p>
<p>为了解决球面贴图展开为矩形时的扭曲问题，可以使用立方体贴图（Cubemap），将环境光照信息映射到一个立方体的六个面上。</p>
<h3 id="bump-mapping-normal-mapping">凹凸贴图 / 法线贴图（Bump Mapping / Normal Mapping）</h3>
<p>贴图中记录表面上每个点的相对高度信息，在渲染时根据高度调整表面法线，从而模拟出表面的凹凸效果。</p>
<p>如何计算一点 <span class="arithmatex">\(P\)</span> 新的法线呢？</p>
<p>假设原始的法线为 <span class="arithmatex">\((0,0,1)\)</span>，高度函数为 <span class="arithmatex">\(h(u,v)\)</span>，<span class="arithmatex">\(u\)</span> 和 <span class="arithmatex">\(v\)</span> 是纹理坐标。</p>
<p>先求点 <span class="arithmatex">\(P\)</span> 分别在 <span class="arithmatex">\(u\)</span> 和 <span class="arithmatex">\(v\)</span> 方向的导数，分别在 <span class="arithmatex">\(u\)</span> 和 <span class="arithmatex">\(v\)</span> 方向上移动一个单位长度，点 <span class="arithmatex">\(P\)</span> 的高度分别为 <span class="arithmatex">\(h(u+1)-h(u)\)</span> 和 <span class="arithmatex">\(h(v+1)-h(v)\)</span>，那么点 <span class="arithmatex">\(P\)</span> 在 <span class="arithmatex">\(u\)</span> 方向上的导数为，其中，<span class="arithmatex">\(c_1\)</span> 和 <span class="arithmatex">\(c_2\)</span> 分别是两个固定的系数：</p>
<div class="arithmatex">\[
\frac{dp}{du} = c_1 * [h(u+1)-h(u)]
\]</div>
<div class="arithmatex">\[
\frac{dp}{dv} = c_2 * [h(v+1)-h(v)]
\]</div>
<p>根据导数，可以求出切线方向向量，然后可以求出法线方向向量：</p>
<div class="arithmatex">\[
\vec{n} = (-dp/du, -dp/dv, 1).normalize()
\]</div>
<p>注意这里的法线是局部空间的法线，需要经过逆转置矩阵变换到世界空间。</p>
<h3 id="displacement-mapping">位移贴图（Displacement Mapping）</h3>
<p>位移贴图同样也是为了模拟表面的凹凸效果，不同的是，位移贴图直接改变表面上每个点的位置，而不是改变法线。</p>
<p>位移贴图要求三角形网格足够密集，使得着色时的采样率能够跟得上贴图的顶点变化速度。</p>
<p>directx有一套近似机制，动态曲面细分（Dynamic Tessellation），可以在渲染时动态增加三角形网格的密度，而不需要建模时就建好密集的网格。</p>
<h3 id="_8">纹理的其他应用</h3>
<ul>
<li>三维噪声（3D Procedural Noise），是一种三维纹理。</li>
<li>环境光遮蔽（Ambient Occlusion），用于模拟环境光照射下在物体表面产生的阴影效果，比如物体表面倒映出屋子里的窗户，只有玻璃是亮的，其他地方是暗的。</li>
<li>用于体积渲染（Volume Rendering）的三维纹理（3D Texture）。</li>
</ul>
<h2 id="shadow-mapping">阴影贴图（Shadow Mapping）</h2>
<p>如何运用光栅化技术来实现阴影效果？</p>
<p>答案是Shadow Mapping（阴影贴图）</p>
<ul>
<li>在计算阴影的过程中，不需要知道场景中的几何信息</li>
<li>可能会产生走样问题</li>
</ul>
<p>要点是只有当light和camera都能看到这个点的时候，我们才认为它不在阴影里，这个很好理解，camera能不能看到这个点决定这个点能不能着色，而light能不能看到这个点决定这个点着什么颜色。</p>
<p>Shadow mapping只能处理点光源。</p>
<p>只能生成硬阴影（Hard Shadow）</p>
<ul>
<li>硬阴影：阴影的轮廓清晰，一个点要么在阴影里，要么不在阴影里</li>
<li>软阴影：阴影的轮廓比较模糊</li>
</ul>
<h3 id="_9">如何实现</h3>
<p>第一步，假设光源的位置有个相机，我们先用光源相机渲染一张深度图（Depth Map），深度图中记录的是从光源看到的每个像素点的深度值。</p>
<p>第二步，从真正的相机位置再次看向场景，对于每个像素点，拿到这个像素点对应的几何点，将这个点变换到光源相机空间，计算出这个点的深度值，然后比较这个深度值和深度图中的深度值之间的关系，如果光源和相机都能看到这个点，这个点不在阴影里，否则，这个点在阴影里。</p>
<p>这个方案存在几个问题：</p>
<ul>
<li>深度图是有一个具体的分辨率的，可能会存在走样问题。</li>
<li>每个光源都会增加一次渲染过程，提高了计算成本。</li>
</ul>
<h3 id="_10">软阴影</h3>
<p>一个完全看不到光源的地方，叫本影（Umbra），一个部分看得到光源的地方，叫半影（Penumbra）。</p>
<p>这是个自然现象，在自然界中有很多例子，比如日食。</p>
<p>这是由于光源本身有一定大小导致的，如果是点光源，则不存在半影。</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      ©2020-2025 shiwj | 津ICP备2020010292号-1
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>